# emacs-plus åˆ°åº•ã€Œå¤šäº†ä»€ä¹ˆã€
æ ¸å¿ƒ patch åŒ…æ‹¬ï¼š
| åŠŸèƒ½                  | è¯´æ˜                 |
| ------------------- | ------------------ |
| ğŸ no-titlebar      | éšè—æ ‡é¢˜æ ï¼Œclient-style |
| ğŸªŸ round-corner     | macOS åœ†è§’           |
| ğŸ¨ icon patch       | æ›´å¥½çœ‹çš„ Emacs.app     |
| ğŸš€ fast native-comp | é’ˆå¯¹ macOS çš„ JIT ä¿®å¤  |
| ğŸ§  smoother frame   | NS è¡Œä¸ºä¿®å¤            |

# å‡†å¤‡ç¯å¢ƒï¼ˆå’Œä½ ç°åœ¨å‡ ä¹ä¸€è‡´ï¼‰
brew install \
  autoconf texinfo pkg-config \
  gmp libgccjit \
  tree-sitter \
  libxml2 jansson \
  imagemagick librsvg webp

# è·å– emacs-plus çš„ patchï¼ˆå…³é”®ï¼‰
# git clone https://github.com/d12frosted/homebrew-emacs-plus.git

# patch åœ¨è¿™é‡Œï¼š
homebrew-emacs-plus/patches/emacs-30/

# å¸¸è§æ–‡ä»¶ï¼ˆä¼šçœ‹åˆ°ç±»ä¼¼ï¼‰ï¼š
emacs-30-no-titlebar.patch
emacs-30-round-undecorated-frame.patch
emacs-30-native-comp.patch
emacs-30-fix-window-role.patch

# è·å– Emacs æºç ï¼ˆå¿…é¡»å¯¹åº”ç‰ˆæœ¬ï¼‰
$ git clone https://git.savannah.gnu.org/git/emacs.git
$ cd emacs
$ git checkout emacs-30

# åº”ç”¨ patchï¼ˆâš ï¸é¡ºåºå¾ˆé‡è¦ï¼‰
è¿›å…¥ Emacs æºç ç›®å½•ï¼š
PATCH_DIR=../homebrew-emacs-plus/patches/emacs-30

# æ¨è patch é¡ºåºï¼ˆå®æµ‹ç¨³å®šï¼‰
patch -p1 < $PATCH_DIR/emacs-30-no-titlebar.patch
patch -p1 < $PATCH_DIR/emacs-30-round-undecorated-frame.patch
patch -p1 < $PATCH_DIR/emacs-30-fix-window-role.patch
patch -p1 < $PATCH_DIR/emacs-30-native-comp.patch

éªŒè¯ï¼š
$ git status

# é…ç½®ï¼ˆå®Œå…¨ emacs-plus é£æ ¼ï¼‰
./autogen.sh

./configure \
  --with-ns \
  --with-native-compilation \
  --with-tree-sitter \
  --with-json \
  --with-modules \
  --with-imagemagick \
  --with-gnutls \
  --without-x \
  --prefix=/opt/emacs-plus-30-$(uname -m)

# ç¼–è¯‘ & App ç”Ÿæˆ
make -j$(sysctl -n hw.ncpu)
make install
make mac-app

ç”Ÿæˆï¼š
nextstep/Emacs.app

> æ›¿æ¢ iconï¼ˆemacs-plus åŒæ¬¾ï¼‰
icon è·¯å¾„ï¼š
homebrew-emacs-plus/icons/Emacs.icns

æ›¿æ¢ï¼š
cp ../homebrew-emacs-plus/icons/Emacs.icns \
   nextstep/Emacs.app/Contents/Resources/

åˆ·æ–° Finderï¼š
$ touch nextstep/Emacs.app

å¤åˆ¶ï¼š
cp -R nextstep/Emacs.app /Applications/Emacs-Plus.app

# éªŒè¯ emacs-plus ç‰¹æ€§
1ï¸âƒ£ æ— æ ‡é¢˜æ 
(frame-parameter nil 'undecorated)

åº”è¿”å›ï¼š
t

2ï¸âƒ£ native-comp
(native-comp-available-p)

3ï¸âƒ£ Doom å…¼å®¹æ€§
rm -rf ~/.emacs.d/.local/cache/eln/
~/.emacs.d/bin/doom sync

# å¯é€‰ï¼šå®Œå…¨å¤åˆ» emacs-plus çš„è¡Œä¸º
ğŸš« ç¦æ­¢ App Nap
defaults write org.gnu.Emacs NSAppSleepDisabled -bool YES

ğŸ§  client æ¨¡å¼æ›´é¡ºæ»‘
defaults write org.gnu.Emacs EmacsFrameTitle -string ""



